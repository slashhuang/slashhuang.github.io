{"version":3,"file":"index.js","sources":["../../src/node/appendHead.ts","../../src/node/utils/getAlternatePaths.ts","../../src/node/utils/getAuthor.ts","../../src/node/utils/getUrl.ts","../../src/node/utils/getCover.ts","../../src/node/utils/getImages.ts","../../src/node/utils/getLinks.ts","../../src/node/utils/logger.ts","../../src/node/getJSONLDInfo.ts","../../src/node/getOGPInfo.ts","../../src/node/appendSEO.ts","../../src/node/generateDescription.ts","../../src/node/generateRobotsTxt.ts","../../src/node/seoPlugin.ts"],"sourcesContent":["import { startsWith } from '@vuepress/helper'\nimport type { HeadConfig } from 'vuepress/core'\nimport type {\n  ArticleSchema,\n  ArticleSeoContent,\n  BlogPostingSchema,\n  SeoContent,\n  WebPageSchema,\n} from '../typings/index.js'\n\ninterface MetaOptions {\n  name: string\n  content: string\n  attribute?: string\n}\n\nconst appendMetaToHead = (\n  head: HeadConfig[],\n  {\n    name,\n    content,\n    attribute = ['article:', 'og:'].some((type) => startsWith(name, type))\n      ? 'property'\n      : 'name',\n  }: MetaOptions,\n): void => {\n  if (content) head.push(['meta', { [attribute]: name, content }])\n}\n\nexport const addOGP = (head: HeadConfig[], content: SeoContent): void => {\n  for (const property in content)\n    switch (property) {\n      case 'article:tag':\n        ;(content as ArticleSeoContent)['article:tag']!.forEach(\n          (tag: string) => {\n            appendMetaToHead(head, { name: 'article:tag', content: tag })\n          },\n        )\n        break\n      case 'og:locale:alternate':\n        content['og:locale:alternate'].forEach((locale: string) => {\n          if (locale !== content['og:locale'])\n            appendMetaToHead(head, {\n              name: 'og:locale:alternate',\n              content: locale,\n            })\n        })\n        break\n      default:\n        if (content[property as keyof SeoContent] as string)\n          appendMetaToHead(head, {\n            name: property,\n            content: content[property as keyof SeoContent] as string,\n          })\n    }\n}\n\nexport const appendJSONLD = (\n  head: HeadConfig[],\n  content: ArticleSchema | BlogPostingSchema | WebPageSchema,\n): void => {\n  head.push([\n    'script',\n    { type: 'application/ld+json' },\n    JSON.stringify(content),\n  ])\n}\n\nexport const appendCanonical = (\n  head: HeadConfig[],\n  url?: string | null,\n): void => {\n  if (url) head.push(['link', { rel: 'canonical', href: url }])\n}\n\nexport const appendAlternate = (\n  head: HeadConfig[],\n  urls: { lang: string; path: string }[],\n): void => {\n  urls.forEach(({ lang, path }) => {\n    head.push([\n      'link',\n      { rel: 'alternate', hreflang: lang.toLowerCase(), href: path },\n    ])\n  })\n}\n","import { entries, isString } from '@vuepress/helper'\nimport type { App, Page } from 'vuepress/core'\n\nexport interface AlternatePath {\n  path: string\n  lang: string\n}\n\nexport const getAlternatePaths = (\n  { lang, path, pathLocale }: Page,\n  { pages, siteData }: App,\n): AlternatePath[] =>\n  entries(siteData.locales)\n    .map(([localePath, { lang: siteLang }]) => ({\n      path: `${localePath}${path.replace(pathLocale, '')}`,\n      lang: siteLang,\n    }))\n    .filter(\n      (item): item is AlternatePath =>\n        isString(item.lang) &&\n        item.lang !== lang &&\n        pages.some(({ path: pagePath }) => pagePath === item.path),\n    )\n","import { isArray, isPlainObject, isString } from '@vuepress/helper'\nimport type { AuthorInfo, SeoAuthor } from '../../typings/index.js'\n\nconst isSEOAuthor = (author: unknown): author is SeoAuthor =>\n  isPlainObject(author) && isString(author.name)\n\nexport const getSEOAuthor = (\n  author: SeoAuthor | false | undefined,\n): AuthorInfo[] => {\n  if (author) {\n    if (isArray(author))\n      return author\n        .map((item) =>\n          isString(item) ? { name: item } : isSEOAuthor(item) ? item : null,\n        )\n        .filter((item): item is AuthorInfo => item !== null)\n\n    if (isString(author)) return [{ name: author }]\n\n    if (isSEOAuthor(author)) return [author]\n\n    // eslint-disable-next-line no-console\n    console.error(\n      `Expect \"author\" to be \\`AuthorInfo[] | AuthorInfo | string[] | string | undefined\\`, but got`,\n      author,\n    )\n\n    return []\n  }\n\n  return []\n}\n","import {\n  isLinkHttp,\n  removeEndingSlash,\n  removeLeadingSlash,\n} from 'vuepress/shared'\n\nexport const getUrl = (hostname: string, base: string, url: string): string =>\n  `${removeEndingSlash(\n    isLinkHttp(hostname) ? hostname : `https://${hostname}`,\n  )}${base}${removeLeadingSlash(url)}`\n","import { isLinkAbsolute, isLinkWithProtocol } from '@vuepress/helper'\nimport type { App } from 'vuepress/core'\nimport type { ExtendPage } from '../../typings/index.js'\nimport { getUrl } from './getUrl.js'\n\nexport const getCover = (\n  { frontmatter }: ExtendPage,\n  { options: { base } }: App,\n  hostname: string,\n): string | null => {\n  const { banner, cover } = frontmatter\n\n  if (banner) {\n    if (isLinkAbsolute(banner)) return getUrl(hostname, base, banner)\n    if (isLinkWithProtocol(banner)) return banner\n  }\n\n  if (cover) {\n    if (isLinkAbsolute(cover)) return getUrl(hostname, base, cover)\n    if (isLinkWithProtocol(cover)) return cover\n  }\n\n  return null\n}\n","import { isLinkAbsolute, isLinkWithProtocol } from '@vuepress/helper'\nimport type { App } from 'vuepress/core'\nimport type { ExtendPage } from '../../typings/index.js'\nimport { getUrl } from './getUrl.js'\n\nconst IMAGE_REG_EXP = /!\\[.*?\\]\\((.*?)\\)/gu\n\nexport const getImages = (\n  { content }: ExtendPage,\n  { options: { base } }: App,\n  hostname: string,\n): string[] =>\n  Array.from(content.matchAll(IMAGE_REG_EXP))\n    .map(([, link]) => {\n      if (isLinkAbsolute(link)) return getUrl(hostname, base, link)\n      if (isLinkWithProtocol(link)) return link\n\n      return null\n    })\n    .filter((item): item is string => item !== null)\n","import { isFunction, isString } from '@vuepress/helper'\nimport type { App } from 'vuepress/core'\nimport { removeEndingSlash } from 'vuepress/shared'\nimport type { ExtendPage } from '../../typings/index.js'\nimport type { SeoPluginOptions } from '../options.js'\nimport { getAlternatePaths } from './getAlternatePaths.js'\nimport { getUrl } from './getUrl.js'\n\nexport const getCanonicalLink = (\n  page: ExtendPage,\n  canonical: SeoPluginOptions['canonical'],\n): string | null =>\n  isFunction(canonical)\n    ? canonical(page)\n    : isString(canonical)\n      ? `${removeEndingSlash(canonical)}${page.path}`\n      : null\n\nexport const getAlternateLinks = (\n  app: App,\n  page: ExtendPage,\n  hostname: string,\n): { lang: string; path: string }[] =>\n  getAlternatePaths(page, app).map(({ lang, path }) => ({\n    lang,\n    path: getUrl(hostname, app.siteData.base, path),\n  }))\n","import { Logger } from '@vuepress/helper'\n\nexport const PLUGIN_NAME = '@vuepress/plugin-seo'\n\nexport const logger = new Logger(PLUGIN_NAME)\n","import { getDate } from '@vuepress/helper'\nimport type { App } from 'vuepress/core'\nimport type {\n  ArticleSchema,\n  BlogPostingSchema,\n  ExtendPage,\n  WebPageSchema,\n} from '../typings/index.js'\nimport type { SeoPluginOptions } from './options.js'\nimport { getCover, getImages, getSEOAuthor } from './utils/index.js'\n\nexport const getJSONLDInfo = (\n  page: ExtendPage,\n  app: App,\n  {\n    isArticle,\n    author: globalAuthor,\n    fallBackImage,\n    hostname,\n  }: {\n    isArticle: Exclude<SeoPluginOptions['isArticle'], undefined>\n    author?: SeoPluginOptions['author']\n    hostname: SeoPluginOptions['hostname']\n    fallBackImage: Exclude<SeoPluginOptions['fallBackImage'], undefined>\n  },\n): ArticleSchema | BlogPostingSchema | WebPageSchema => {\n  const {\n    title,\n    frontmatter: { author: pageAuthor, description, time, date = time },\n    data: { git = {} },\n  } = page\n\n  const author = getSEOAuthor(pageAuthor || globalAuthor)\n  const datePublished = getDate(date)?.toISOString()\n  const dateModified = git.updatedTime\n    ? new Date(git.updatedTime).toISOString()\n    : null\n  const cover = getCover(page, app, hostname)\n  const images = getImages(page, app, hostname)\n\n  return isArticle(page)\n    ? {\n        '@context': 'https://schema.org',\n        '@type': 'Article',\n        'headline': title,\n        'image': images.length ? images : [cover || fallBackImage],\n        datePublished,\n        dateModified,\n        'author': author.map((item) => ({ '@type': 'Person', ...item })),\n      }\n    : {\n        '@context': 'https://schema.org',\n        '@type': 'WebPage',\n        'name': title,\n        ...(description ? { description } : {}),\n      }\n}\n","import { getDate, isArray, isString } from '@vuepress/helper'\nimport type { App } from 'vuepress/core'\nimport type { ExtendPage, SeoContent } from '../typings/index.js'\nimport type { SeoPluginOptions } from './options.js'\nimport {\n  getAlternatePaths,\n  getCover,\n  getImages,\n  getSEOAuthor,\n  getUrl,\n} from './utils/index.js'\n\nexport const getOGPInfo = (\n  page: ExtendPage,\n  app: App,\n  {\n    isArticle,\n    author: globalAuthor,\n    hostname,\n    fallBackImage,\n    restrictions,\n    twitterID,\n  }: {\n    isArticle: Exclude<SeoPluginOptions['isArticle'], undefined>\n    author?: SeoPluginOptions['author']\n    hostname: SeoPluginOptions['hostname']\n    fallBackImage: Exclude<SeoPluginOptions['fallBackImage'], undefined>\n    restrictions?: SeoPluginOptions['restrictions']\n    twitterID?: SeoPluginOptions['twitterID']\n  },\n): SeoContent => {\n  const { base, title: siteTitle, locales } = app.siteData\n  const {\n    frontmatter: {\n      author: pageAuthor,\n      time,\n      date = time,\n      tag,\n      tags = tag as string[],\n    },\n    data: { git = {} },\n  } = page\n\n  const author = getSEOAuthor(pageAuthor || globalAuthor)\n  const modifiedTime = git.updatedTime\n    ? new Date(git.updatedTime).toISOString()\n    : null\n  const articleTags = isArray(tags) ? tags : isString(tag) ? [tag] : []\n  const articleTitle = page.title\n  const cover = getCover(page, app, hostname)\n  const images = getImages(page, app, hostname)\n  const alternateLocalePaths = getAlternatePaths(page, app)\n  const publishedTime = getDate(date)?.toISOString()\n\n  const ogImage = cover || images[0] || fallBackImage\n\n  const defaultOGP: SeoContent = {\n    'og:url': getUrl(hostname, base, page.path),\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n    'og:site_name': locales[page.pathLocale]?.title || siteTitle,\n    'og:title': articleTitle,\n    'og:description': page.frontmatter.description || '',\n    'og:type': isArticle(page) ? 'article' : 'website',\n    'og:image': ogImage,\n    'og:locale': page.lang,\n    'og:locale:alternate': alternateLocalePaths.map(({ lang }) => lang),\n    ...(modifiedTime ? { 'og:updated_time': modifiedTime } : {}),\n    ...(restrictions ? { 'og:restrictions:age': restrictions } : {}),\n    ...(twitterID ? { 'twitter:creator': twitterID } : {}),\n    ...(cover\n      ? {\n          'twitter:card': 'summary_large_image',\n          'twitter:image:src': cover,\n          'twitter:image:alt': articleTitle,\n        }\n      : {}),\n\n    'article:author': author[0]?.name,\n    'article:tag': articleTags,\n    ...(publishedTime ? { 'article:published_time': publishedTime } : {}),\n    ...(modifiedTime ? { 'article:modified_time': modifiedTime } : {}),\n  }\n\n  return defaultOGP\n}\n","import type { App } from 'vuepress/core'\nimport type { ExtendPage } from '../typings/index.js'\nimport {\n  addOGP,\n  appendAlternate,\n  appendCanonical,\n  appendJSONLD,\n} from './appendHead.js'\nimport { getJSONLDInfo } from './getJSONLDInfo.js'\nimport { getOGPInfo } from './getOGPInfo.js'\nimport type { SeoPluginOptions } from './options.js'\nimport { getAlternateLinks, getCanonicalLink, logger } from './utils/index.js'\n\nexport const appendSEO = (\n  app: App,\n  {\n    author,\n    canonical,\n    fallBackImage = '',\n    hostname,\n    isArticle = (articlePage): boolean =>\n      Boolean(articlePage.filePathRelative && !articlePage.frontmatter.home),\n    customHead,\n    ogp,\n    jsonLd,\n    ...rest\n  }: SeoPluginOptions,\n): void => {\n  app.pages.forEach((page: ExtendPage) => {\n    const head = page.frontmatter.head ?? []\n\n    const canonicalLink = getCanonicalLink(page, canonical)\n    const alternateLinks = getAlternateLinks(app, page, hostname)\n\n    appendCanonical(head, canonicalLink)\n    appendAlternate(head, alternateLinks)\n\n    if (page.frontmatter.seo !== false) {\n      const defaultOGP = getOGPInfo(page, app, {\n        isArticle,\n        fallBackImage,\n        hostname,\n        ...rest,\n      })\n      const defaultJSONLD = getJSONLDInfo(page, app, {\n        isArticle,\n        hostname,\n        author,\n        fallBackImage,\n      })\n\n      const ogpContent = ogp ? ogp(defaultOGP, page, app) : defaultOGP\n\n      const jsonLDContent = jsonLd\n        ? jsonLd(defaultJSONLD, page, app)\n        : defaultJSONLD\n\n      if (app.env.isDebug) {\n        logger.info(`OGP of ${page.path}:`, ogpContent)\n        logger.info(`JSON-LD of ${page.path}:`, ogpContent)\n      }\n\n      addOGP(head, ogpContent)\n      appendJSONLD(head, jsonLDContent)\n\n      if (customHead) customHead(head, page, app)\n    }\n\n    page.frontmatter.head = head\n  })\n}\n","import { getPageExcerptContent, getText } from '@vuepress/helper'\nimport type { App } from 'vuepress/core'\nimport type { ExtendPage } from '../typings/index.js'\n\nexport const generateDescription = (\n  app: App,\n  page: ExtendPage,\n  autoDescription = true,\n): void => {\n  // generate description\n  if (!page.frontmatter.description && autoDescription) {\n    const content = getPageExcerptContent(page.content)\n      ? (page.data.excerpt ?? page.contentRendered)\n      : page.contentRendered\n\n    const pageText = getText(content, app.siteData.base, {\n      length: 180,\n      singleLine: true,\n    })\n\n    if (pageText.length) {\n      page.frontmatter.description =\n        pageText.length > 180 ? `${pageText.slice(0, 177)}...` : pageText\n      page.data.autoDesc = true\n    }\n  }\n}\n","import type { App } from 'vuepress/core'\nimport { fs } from 'vuepress/utils'\nimport { logger } from './utils/index.js'\n\nexport const generateRobotsTxt = async (app: App): Promise<void> => {\n  const { succeed, fail } = logger.load('Generating robots.txt')\n  const publicPath = app.dir.public('robots.txt')\n\n  let content = fs.existsSync(publicPath)\n    ? await fs.readFile(publicPath, { encoding: 'utf8' })\n    : ''\n\n  if (content && !content.includes('User-agent')) {\n    fail('robots.txt seems invalid!')\n  } else {\n    content += '\\nUser-agent:*\\nDisallow:\\n'\n\n    await fs.writeFile(app.dir.dest('robots.txt'), content, {\n      flag: 'w',\n    })\n\n    succeed()\n  }\n}\n","import type { Plugin, PluginFunction } from 'vuepress/core'\nimport { colors } from 'vuepress/utils'\nimport type { ExtendPage } from '../typings/index.js'\nimport { appendSEO } from './appendSEO.js'\nimport { generateDescription } from './generateDescription.js'\nimport { generateRobotsTxt } from './generateRobotsTxt.js'\nimport type { SeoPluginOptions } from './options.js'\nimport { PLUGIN_NAME, logger } from './utils/index.js'\n\nexport const seoPlugin =\n  (options: SeoPluginOptions): PluginFunction =>\n  (app) => {\n    if (app.env.isDebug) logger.info('Options:', options)\n\n    const { autoDescription = true, hostname, ...rest } = options\n\n    const plugin: Plugin = { name: PLUGIN_NAME }\n\n    if (!hostname) {\n      logger.error(`Option ${colors.magenta('hostname')} is required!`)\n\n      return plugin\n    }\n\n    return {\n      ...plugin,\n\n      extendsPage: (page: ExtendPage): void => {\n        if (page.frontmatter.seo !== false)\n          generateDescription(app, page, autoDescription)\n      },\n\n      onInitialized: (): void => {\n        appendSEO(app, { hostname, ...rest })\n      },\n\n      onGenerated: (): Promise<void> => generateRobotsTxt(app),\n    }\n  }\n"],"names":["appendMetaToHead","head","name","content","attribute","type","startsWith","addOGP","property","tag","locale","appendJSONLD","appendCanonical","url","appendAlternate","urls","lang","path","getAlternatePaths","pathLocale","pages","siteData","entries","localePath","siteLang","item","isString","pagePath","isSEOAuthor","author","isPlainObject","getSEOAuthor","isArray","getUrl","hostname","base","removeEndingSlash","isLinkHttp","removeLeadingSlash","getCover","frontmatter","banner","cover","isLinkAbsolute","isLinkWithProtocol","IMAGE_REG_EXP","getImages","link","getCanonicalLink","page","canonical","isFunction","getAlternateLinks","app","PLUGIN_NAME","logger","Logger","getJSONLDInfo","isArticle","globalAuthor","fallBackImage","title","pageAuthor","description","time","date","git","datePublished","getDate","dateModified","images","getOGPInfo","restrictions","twitterID","siteTitle","locales","tags","modifiedTime","articleTags","articleTitle","alternateLocalePaths","publishedTime","ogImage","appendSEO","articlePage","customHead","ogp","jsonLd","rest","canonicalLink","alternateLinks","defaultOGP","defaultJSONLD","ogpContent","jsonLDContent","generateDescription","autoDescription","getPageExcerptContent","pageText","getText","generateRobotsTxt","succeed","fail","publicPath","fs","seoPlugin","options","plugin","colors"],"mappings":"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"}