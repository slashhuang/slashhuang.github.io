---
title: 移动端事件处理
date: 2016-05-20 16:00:14
tags:
- 移动端
- 事件
---

## 1、测试移动端事件代码

```html
  <div id="d" style="width: 100px; height: 100px; border: 1px solid black;">
  </div>
  <button id="reset">reset</button>
  <div id="container"></div>
  </body>
  <script type="text/javascript">
      $('#reset').bind('click',function(){
          $('#container').empty();
      });
      var startTime;
      var log = function (msg,e) {
          var clientX="clientX ";
          if(msg.match('touchmove')){
              clientX+=(e['targetTouches'][0].clientX+'').substr(0,3);
          }
          var div = $('<div></div>');
          div.html((new Date().getTime()+'').substring(6) + ': ' + (new Date().getTime() - startTime) + ': ' + clientX+msg)
          $('#container').append(div);
  
      };
      var addListener= function (type,func) {
          var d = document.getElementById('d');
          d.addEventListener(type,func)
      };
      var touchStart = function (e) {
          startTime = new Date().getTime();
          log('touchStart',e);
      };
      var touchMove = function (e) {
          log('touchmove',e);
      };
      var touchEnd = function (e) {
          log('touchEnd',e);
  
      };
      var mouseDown = function () {
          log('mouseDown');
      };
      var click = function () {
          log('clickend');
      };
      var mouseClick = function () {
          log('mouseClick');
      };
      var mouseUp = function () {
          log('mouseUp');
      };
      var mouseOver = function () {
          log('mouseOver');
      };
      addListener('mousedown', mouseDown);
      addListener('mouseover', mouseOver);
      addListener('click', mouseClick);
      addListener('mouseup', mouseUp);
      addListener('touchstart', touchStart);
      addListener('touchend', touchEnd);
      addListener('click', click);
      addListener('touchmove', touchMove);
```

### 快速点击下的测试结果
> 华为荣耀手机(网页性能超乎预期，点击会在touchEnd后立即执行)
``` bash
    //test1
    touchStart 1
    touchEnd  74
    mouseOver 82
    mouseDown 86
    mouseUp   93
    mouseClick 94
    clickEnd 95
    //test2
    touchStart 1
    touchEnd  107
    mouseOver 117
    mouseDown 121
    mouseUp   129
    mouseClick 131
    clickEnd 133
```

> 三星手机(点击事件相比touch大致会有200ms的延迟)
``` bash
    //test1
    touchStart 1
    touchEnd  63
    mouseOver 258
    mouseDown 260
    mouseUp   265
    mouseClick 271
    clickEnd 275 
```
> iphone 4s(点击事件相比touch大致会有300ms的延迟,同时mouseover将会劫持后续的click事件)
``` bash
    //测试1
    touchStart 1
    touchEnd  36
    mouseDown 394
    mouseUp   404
    mouseClick 405
    clickEnd 406
    touchStart 1
    touchEnd  63
    mouseDown 251
    mouseUp   255
    mouseClick 257
    clickEnd 259
    //测试2
    touchStart 1
    touchEnd  59
    mouseOver 418               
```
> iphone 6
``` bash
    //测试1
    touchStart 1
    touchEnd  48
    mouseOver 412
    //测试2
    touchStart 1
    touchEnd  50
    mouseDown 420
    mouseUp   428
    mouseClick 429
    clickEnd 430    
```

### 点击小结 手机点按触发顺序touch会在mouseEvents之前
---
### 2、手指移动测试结果
>测试数据暂时不给出，大致的情况是touchmove事件的触发往往和触发click事件互斥